javascript:(async function(){function getCurrentGid(){const urlMatch=window.location.href.match(/gid=([0-9]+)/);return urlMatch?urlMatch[1]:'0';}function delay(ms){return new Promise(resolve=>setTimeout(resolve,ms));}function dispatchClick(e){try{e.dispatchEvent(new MouseEvent('mousedown',{bubbles:!0,cancelable:!0,view:window}));e.dispatchEvent(new MouseEvent('mouseup',{bubbles:!0,cancelable:!0,view:window}));e.dispatchEvent(new MouseEvent('click',{bubbles:!0,cancelable:!0,view:window}));return!0;}catch(t){return!1;}}function getActiveSheetName(){const e=document.querySelector('.docs-sheet-active-tab .docs-sheet-tab-name');return e?e.textContent.trim():'Name_NOT_FOUND';}async function fullyAutomateGidCollection(){const e=window.location.href.match(/\/d\/([a-zA-Z0-9_-]+)/);const t=e?e[1]:'SheetId_NOT_FOUND';if(t==='SheetId_NOT_FOUND'){console.error('‚ùå –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ ID –¢–∞–±–ª–∏—Ü—ã.');return;}const o=Array.from(document.querySelectorAll('.docs-sheet-tab[role="button"]')).filter(e=>e.id&&e.querySelector('.docs-sheet-tab-name'));if(o.length===0){console.error('‚ùå –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');return;}const n={};const l=o.length;const r=15;const s=500;let c=getCurrentGid();const a=getActiveSheetName();const d="NoAPIfor"+t;console.log(`\n\n======================================================\n‚ú® GID –°–±–æ—Ä—â–∏–∫ v7.2: –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä...\n–ù–∞–π–¥–µ–Ω–æ ${l} –ª–∏—Å—Ç–æ–≤. Sheet ID: ${t}.\nAPI placeholder: ${d}\n======================================================`);for(let i=0;i<l;i++){const h=o[i];const u=h.querySelector('.docs-sheet-tab-name').textContent.trim();console.log(`\nü§ñ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏—Å—Ç–∞: ${i+1}/${l} - ${u}`);let f=c;let p=!0;if(u===a&&i===0){p=!1;console.log('   üí° –õ–∏—Å—Ç –∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. GID –±–µ—Ä–µ—Ç—Å—è –∏–∑ URL.');}if(p){if(!dispatchClick(h)){console.error('   ‚ùå –°–±–æ–π –∫–ª–∏–∫–∞. –ü—Ä–æ–ø—É—Å–∫–∞—é.');continue;}let g=0;while(c===f&&g<r){await delay(s);c=getCurrentGid();g++;}if(c===f){console.error(`   ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ–π: GID –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è –∑–∞ ${g*s}–º—Å. –ü—Ä–æ–ø—É—Å–∫–∞—é.`);continue;}}else{c=getCurrentGid();f=c;}const m=u.replace(/\s+|\/|-/g,'_').replace(/[^a-zA-Z0-9_\u0400-\u04FF]/g,'').substring(0,25);if(m){n[m]={sheetId:t,gid:c,name:u,api:d};console.log(`   ‚úÖ –£—Å–ø–µ—Ö! GID: ${c}, API: ${d}`);}else{console.warn(`   ‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á –¥–ª—è "${u}". –ü—Ä–æ–ø—É—Å–∫–∞—é.`);}}const jsonOutput=JSON.stringify(n,null,2);console.log('\n======================================================');console.log(`–í–°–ï–ì–û –°–û–ë–†–ê–ù–û: ${Object.keys(n).length} GID.`);console.log('–ö–û–ü–ò–†–£–ô–¢–ï –ü–û–õ–ù–´–ô JSON-–û–ë–™–ï–ö–¢ –ù–ò–ñ–ï:\n');console.log(jsonOutput);console.log('======================================================');alert('–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü—ã –∑–∞–≤–µ—Ä—à–µ–Ω.\n\n–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–µ–¥–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å (F12 ‚Üí Console).');}fullyAutomateGidCollection();})();
