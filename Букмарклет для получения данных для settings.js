javascript:(async function(){function getCurrentGid(){const gidMatch=window.location.href.match(/gid=([0-9]+)/);return gidMatch?gidMatch[1]:'0';}function delay(ms){return new Promise(resolve=>setTimeout(resolve,ms));}function dispatchClick(element){try{element.dispatchEvent(new MouseEvent('mousedown',{bubbles:true,cancelable:true,view:window}));element.dispatchEvent(new MouseEvent('mouseup',{bubbles:true,cancelable:true,view:window}));element.dispatchEvent(new MouseEvent('click',{bubbles:true,cancelable:true,view:window}));return true;}catch(e){console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫:',e);return false;}}function getActiveSheetName(){const nameElement=document.querySelector('.docs-sheet-active-tab .docs-sheet-tab-name');return nameElement?nameElement.textContent.trim():'Name_NOT_FOUND';}async function fullyAutomateGidCollection(){const sheetIdMatch=window.location.href.match(/\/d\/([a-zA-Z0-9_-]+)/);const sheetId=sheetIdMatch?sheetIdMatch[1]:'SheetId_NOT_FOUND';if(sheetId==='SheetId_NOT_FOUND'){alert('–û—à–∏–±–∫–∞: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Google –¢–∞–±–ª–∏—Ü—ã.');return;}const tabElements=Array.from(document.querySelectorAll('.docs-sheet-tab[role="button"]')).filter(tab=>tab.id&&tab.querySelector('.docs-sheet-tab-name'));if(tabElements.length===0){alert('–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DOM.');return;}const collectedGids={};const totalTabs=tabElements.length;const maxAttempts=15;const delayMs=500;let currentGid=getCurrentGid();const activeNameAtStart=getActiveSheetName();for(let i=0;i<totalTabs;i++){const tab=tabElements[i];const tabName=tab.querySelector('.docs-sheet-tab-name').textContent.trim();console.log(`ü§ñ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏—Å—Ç–∞: ${i+1}/${totalTabs} - ${tabName}`);let initialGid=currentGid;let needsClick=true;if(tabName===activeNameAtStart){needsClick=false;console.log('üí° –ü–µ—Ä–≤—ã–π –ª–∏—Å—Ç –∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ. –°–æ—Ö—Ä–∞–Ω—è–µ–º GID –±–µ–∑ –∫–ª–∏–∫–∞.');}if(needsClick){if(!dispatchClick(tab)){console.error(`‚ùå –°–±–æ–π: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∏–∫ –¥–ª—è ${tabName}. –ü—Ä–æ–ø—É—Å–∫–∞—é.`);continue;}let attempts=0;while(currentGid===initialGid&&attempts<maxAttempts){await delay(delayMs);currentGid=getCurrentGid();attempts++;}if(currentGid===initialGid){console.error(`‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ–π: GID –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è –¥–ª—è –ª–∏—Å—Ç–∞ "${tabName}" –∑–∞ ${maxAttempts*delayMs}–º—Å. –ü—Ä–æ–ø—É—Å–∫–∞—é.`);continue;}}else{currentGid=getCurrentGid();initialGid=currentGid;}const configKey=tabName.replace(/\s+|\/|-/g,'_').replace(/[^a-zA-Z0-9_\u0400-\u04FF]/g,'').substring(0,25);if(configKey){collectedGids[configKey]={sheetId:sheetId,gid:currentGid,name:tabName};console.log(`‚úÖ –£—Å–ø–µ—Ö! GID: ${currentGid}`);}else{console.warn(`‚ö†Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á –¥–ª—è "${tabName}"`);}}const jsonOutput=JSON.stringify(collectedGids,null,2);console.log('======================================================');console.log(`‚ú® –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø GID –î–õ–Ø –¢–ê–ë–õ–ò–¶–´ '${sheetId}' (${Object.keys(collectedGids).length} –ª–∏—Å—Ç–æ–≤):`);console.log(jsonOutput);console.log('======================================================');alert('–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü—ã –∑–∞–≤–µ—Ä—à–µ–Ω./n –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–µ–¥–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å (F12 ‚Üí Console).');}fullyAutomateGidCollection();})();
